{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load i18n %}


{% block content %}

   <div class="row">
       <div class="col-md-9">
           <h1>{{blog.subject}}

            {% if blog.owner == request.user %}
             <small>
                 
             <a href="#" data-toggle="modal" data-target="#blogModal"><i class="fa fa-pencil"></i></a>
             </small>
             {% endif %}   
                               
           </h1>
           <hr>    
              <span class="label label-success">{{blog.tags}}</span> {{blog.createtime|date:'Y-m-d H:i'}}  {{blog.owner}}<br><br>
              {{blog.content|safe}}
            
            <!-- comments -->
            {% if comments %}
                {% for comment in comments %}  
                <hr>
                <div class="row">
                    <div class="col-md-2">
                        {{comment.owner}}
                    </div>    
                    <div class="col-md-10">
                                <p>{{comment.comment|safe}}</p>
                                <br>
                                <div class="pull-right">
                                    {{comment.create_time|date:'Y-m-d'}}     
                                </div>    
                     

                    </div>    
                  </div>

                            {% endfor %}
                        {% endif %}                     
                        {% if request.user.is_authenticated %}
                        <div><br>
                        <hr>    
                        <span id="span_a_suggest"><a id="a_suggest" href="#"><i class="fa fa-commenting"></i> Comment</a></span>
                        <div class="comment_form">
                          <form method="POST" action="{% url 'comment_new'  blog.id %}">
                            {% csrf_token %}
                            
                            {{ comment_form|crispy }}
                            <input class="btn btn-success pull-right" type="submit" name="Submit" value="Save"/>
                          </form>      
                        </div>
                        </div>
                        {% endif %}<!-- end of user authentication -->                  
                </div>      

       </div>
       <!-- button -->
       
       <div class="col-md-3">
           <div class="row">
         <!-- Button trigger modal -->
         <br>


         <br>
         
         <!-- blog Modal -->
         <div class="modal fade" id="blogModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
           <div class="modal-dialog" role="document">
             <div class="modal-content">
               <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                 <h4 class="modal-title" id="myModalLabel">Edit</h4>
               </div>
               <div class="modal-body">
                  <form method="POST" action="{% url 'blog_edit' id=blog.id %}">
                    {% csrf_token %}
                    {{ blog_form|crispy }}
                    <input class="btn btn-success" type="submit" name="Submit" value="Save"/>
                  </form>
               </div>
             </div>
           </div>
         </div>          

         </div>
        </div>  
        </div>    
       </div>       
    
    </div>   
{% endblock %}

{% block script%}
{{ block.super }}
<script>

$(document).ready(function(){
    $("#a_suggest").click(function(e){
        e.preventDefault();
        $(".comment_form").show();
        $("#span_a_suggest").hide();
    });
});

</script>  
{% endblock %}