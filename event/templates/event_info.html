{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load i18n %}


{% block content %}
   <div class="row">
       <div class="col-md-9">
           <h1>{{event.subject}}

            {% if event.owner == request.user.id %}
             <small>
                 
             <a href="#" data-toggle="modal" data-target="#eventModal"><i class="fa fa-pencil"></i></a>
             </small>
             {% endif %}             
           </h1>
            <table class="table">
                
                <tr><td>Time</td><td>{{event.do_time|date:'Y-m-d H:i'}}</td></tr>
                <tr><td>Description</td><td>{{event.description|safe}}</td></tr>
                

            </table>   
            <!-- comments -->
            {% if comments %}
                {% for comment in comments %}  
                <hr>
                <div class="row">
                    <div class="col-md-2">
                        {{comment.owner}}
                    </div>    
                    <div class="col-md-10">
                                <p>{{comment.comment|safe}}</p>
                                <br>
                                <div class="pull-right">
                                    {{comment.create_time|date:'Y-m-d'}}     
                                </div>    
                     

                    </div>    
                  </div>

                            {% endfor %}
                        {% endif %}    
                        
                        {% if request.user.is_authenticated %}
                        <div><br>
                        <hr>    
                        <span id="span_a_suggest"><a id="a_suggest" href="#"><i class="fa fa-commenting"></i> Comment</a></span>
                        <div class="comment_form">
                          <form method="POST" action="{% url 'comment_new'  event.id %}">
                            {% csrf_token %}
                            
                            {{ comment_form|crispy }}
                            <input class="btn btn-success pull-right" type="submit" name="Submit" value="Save"/>
                          </form>      
                        </div>
                        </div>
                        {% endif %}<!-- end of user authentication -->                    
                
       </div>
       <!-- button -->
       
       <div class="col-md-3">
           <div class="row">
         <!-- Button trigger modal -->
         <br> <br>
         <!-- event Modal -->
         <div class="modal fade" id="eventModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
           <div class="modal-dialog" role="document">
             <div class="modal-content">
               <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                 <h4 class="modal-title" id="myModalLabel">Edit</h4>
               </div>
               <div class="modal-body">
                  <form method="POST" action="{% url 'event_edit' id=event.id %}">
                    {% csrf_token %}
                    
                    {{ event_form|crispy }}
                    
                    <input class="btn btn-primary" type="submit" name="Submit" value="Save"/>
                  </form>
               </div>
             </div>
           </div>
         </div>          

         </div>

        </div>  
        </div>    
       </div>       
       
     
    </div>   
{% endblock %}
{% block script%}
{{ block.super }}
<script>

$(document).ready(function(){
    $("#a_suggest").click(function(e){
        e.preventDefault();
        $(".comment_form").show();
        $("#span_a_suggest").hide();
    });
});

</script>  
{% endblock %}